---
title: "report"
author: "Julia Cha≈Çasiak"
date: "20 11 2021"
output:
  html_document:
    toc: true
    toc_float: true
    theme: spacelab
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
```{r message=FALSE}
library(dplyr)
library(tidyr)
library(ggplot2)
library(readxl)
library(imputeTS)
```


## R Wczytywanie danych


```{r datasets_reading}
currExchRates <- read.csv("./datasets/CurrencyExchangeRates.csv")
goldPrices <- read.csv("./datasets/Gold prices.csv")
spComposite <- read.csv("./datasets/S&P Composite.csv")
worldDevInd <- read_xlsx("./datasets/World_Development_Indicators.xlsx")
worldDevInd <- data.frame(worldDevInd)
btcMetadata <- read.csv("./datasets/BCHAIN_metadata.csv")
btcDiff <- read.csv("./datasets/BCHAIN-DIFF.csv")
btcHrate <- read.csv("./datasets/BCHAIN-HRATE.csv")
btcMkpru <- read.csv("./datasets/BCHAIN-MKPRU.csv")
btcTrvou <- read.csv("./datasets/BCHAIN-TRVOU.csv")
```

## Bitcoin's data

```{r bitcoin simple}
ggplot(btcDiff, aes(x=Date, y=Value, group = 1)) + geom_line()
ggplot(btcHrate, aes(x=Date, y=Value, group = 1)) + geom_line()
ggplot(btcMkpru, aes(x=Date, y=Value, group = 1)) + geom_line()
ggplot(btcTrvou, aes(x=Date, y=Value, group = 1)) + geom_line()
```

## Preparing Currency Data

```{r tidy_currency}
currExchWithoutNA <- currExchRates %>% select(which(colMeans(is.na(.)) < 0.2))
currExchAfterEuro <- currExchWithoutNA %>% mutate(Euro = ifelse(Date < as.Date("1998-10-30", format="%Y-%m-%d"), 0, Euro))
CurrExchRatesClean <- na_ma(currExchAfterEuro, k = 1)
```

## Preparing Gold Prices Data

```{r tidy_gold}
goldPricesAfter <- goldPrices %>% mutate(
  EURO..AM. = ifelse(Date < as.Date("1998-12-31", format="%Y-%m-%d"), 0, EURO..AM.),
  EURO..PM. = ifelse(Date < as.Date("1998-12-31", format="%Y-%m-%d"), 0, EURO..PM.),
  USD..PM. = ifelse(Date < as.Date("1968-03-14", format="%Y-%m-%d"), 0, USD..PM.),
  GBP..PM. = ifelse(Date < as.Date("1968-03-14", format="%Y-%m-%d"), 0, GBP..PM.))
goldPricesClean <- na_ma(goldPricesAfter, k = 1)
```

## Preparing World Dev Index

```{r tidy_index}
worldDevIndAfter <- pivot_longer(worldDevInd, 'X1970..YR1970.':'X2020..YR2020.', names_to = "Year",
values_to = "Value", values_drop_na = FALSE)
worldDevIndClean <- worldDevIndAfter %>% 
  mutate(Year = substr(Year, 2, 5)) %>% 
  filter(grepl('', Series.Name)) %>%
  relocate(Year, .after = Country.Code)
```


## Preparing SP Composite
```{r tidy_sp_composite}
spCompositeClean <- spComposite %>% 
  mutate(Cyclically.Adjusted.PE.Ratio = ifelse(Year < as.Date("1880-12-31", format="%Y-%m-%d"), 0, Cyclically.Adjusted.PE.Ratio))
spCompositeClean <- na_ma(spCompositeClean, k = 1)

```





